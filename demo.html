<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤–å–å…¨æµç¨‹ä»¿çœŸ Pro</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --user-bg: #f0f7ff; --user-main: #2196f3;
            --merch-bg: #fff8e1; --merch-main: #ff9800;
            --rider-bg: #f1f8e9; --rider-main: #43a047;
            --gray: #757575;
        }
        
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #eef1f5;
            height: 100vh;
            overflow: hidden; /* ç¦æ­¢æ•´ä¸ªé¡µé¢æ»šåŠ¨ï¼Œåªå…è®¸å†…éƒ¨åŒºåŸŸæ»šåŠ¨ */
        }

        /* ============ æ ¸å¿ƒå¸ƒå±€ ============ */
        #app {
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        header {
            background: #333;
            color: white;
            padding: 10px 20px;
            text-align: center;
            font-size: 1.2rem;
            flex-shrink: 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .main-stage {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
            padding: 15px;
            overflow: hidden; /* é˜²æ­¢ç½‘æ ¼æ’‘ç ´å±å¹• */
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }

        /* ============ è§’è‰²é¢æ¿é€šç”¨ç»“æ„ ============ */
        .role-panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            overflow: hidden; /* å…³é”®ï¼šé™åˆ¶é¢æ¿æº¢å‡º */
            border-top: 5px solid #ccc;
            transition: all 0.3s;
        }

        .panel-header {
            padding: 15px;
            font-weight: bold;
            font-size: 1.1em;
            flex-shrink: 0; /* æ ‡é¢˜ä¸å‹ç¼© */
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        /* å…³é”®ï¼šå†…å®¹æ»šåŠ¨åŒºåŸŸ */
        .panel-content {
            flex: 1;
            overflow-y: auto; /* å…è®¸å‚ç›´æ»šåŠ¨ */
            padding: 15px;
            background-color: #fafafa;
            position: relative;
        }

        /* åº•éƒ¨å›ºå®šæ“ä½œæ ï¼ˆå¦‚ä¸‹å•æŒ‰é’®ï¼‰ */
        .panel-footer {
            padding: 15px;
            background: white;
            border-top: 1px solid #eee;
            flex-shrink: 0;
        }

        /* ç¾åŒ–æ»šåŠ¨æ¡ */
        .panel-content::-webkit-scrollbar { width: 6px; }
        .panel-content::-webkit-scrollbar-track { background: transparent; }
        .panel-content::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }
        .panel-content::-webkit-scrollbar-thumb:hover { background: #aaa; }

        /* ============ è§’è‰²ç‰¹å®šé…è‰² ============ */
        .role-user { border-color: var(--user-main); }
        .role-user .panel-header { background: var(--user-bg); color: var(--user-main); }
        
        .role-merchant { border-color: var(--merch-main); }
        .role-merchant .panel-header { background: var(--merch-bg); color: #d84315; }

        .role-rider { border-color: var(--rider-main); }
        .role-rider .panel-header { background: var(--rider-bg); color: #2e7d32; }

        /* ============ ç»„ä»¶æ ·å¼ ============ */
        
        /* èœå• Grid */
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }
        .menu-item {
            background: white;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: 0.2s;
        }
        .menu-item.active {
            border-color: var(--user-main);
            background-color: #e3f2fd;
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(33, 150, 243, 0.2);
        }

        /* è®¢å•å¡ç‰‡é€šç”¨ */
        .order-card {
            background: white;
            border-radius: 8px;
            margin-bottom: 12px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
            padding: 12px;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        /* å•†å®¶ç«¯ï¼šæ¨¡æ‹Ÿçƒ­æ•å°ç¥¨æ‰“å°æ•ˆæœ */
        .receipt-card {
            font-family: 'Courier New', Courier, monospace; /* ç­‰å®½å­—ä½“ */
            background: #fff;
            border: 1px solid #e0e0e0;
            border-top: none;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            position: relative;
            /* é”¯é½¿è¾¹ç¼˜æ¨¡æ‹Ÿ (ç®€å•ç‰ˆ) */
            border-bottom: 2px dashed #ccc; 
        }
        
        /* æ‰“å°åŠ¨ç”» */
        .printing-animation {
            animation: printSlide 2s cubic-bezier(0.25, 1, 0.5, 1) forwards;
            transform-origin: top center;
            overflow: hidden;
            max-height: 0;
            opacity: 0;
        }

        @keyframes printSlide {
            0% { max-height: 0; opacity: 0.5; }
            100% { max-height: 500px; opacity: 1; }
        }

        .receipt-header {
            text-align: center;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 8px;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .receipt-row { display: flex; justify-content: space-between; margin-bottom: 4px; }
        .receipt-divider { border-bottom: 1px dashed #ccc; margin: 8px 0; }

        /* æ ‡ç­¾ä¸æŒ‰é’® */
        .tag { padding: 2px 6px; border-radius: 4px; font-size: 12px; }
        .tag-del { background: #e3f2fd; color: #1976d2; }
        .tag-pick { background: #fff3e0; color: #f57c00; }
        
        .btn {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: opacity 0.2s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 6px;
        }
        .btn:hover { opacity: 0.9; }
        .btn:disabled { background: #ccc !important; cursor: not-allowed; }
        
        .btn-blue { background: var(--user-main); color: white; }
        .btn-orange { background: var(--merch-main); color: white; }
        .btn-green { background: var(--rider-main); color: white; }

        /* Tab åˆ‡æ¢ */
        .tabs { display: flex; border-bottom: 1px solid #eee; margin-bottom: 10px; background: white; position: sticky; top: 0; z-index: 5; }
        .tab { flex: 1; text-align: center; padding: 10px; cursor: pointer; color: #888; font-size: 0.9rem; }
        .tab.active { color: #333; font-weight: bold; border-bottom: 2px solid #333; }
        .badge { background: #f44336; color: white; border-radius: 10px; padding: 0 5px; font-size: 10px; vertical-align: super; }

        /* çŠ¶æ€æç¤º */
        .empty-state { text-align: center; color: #999; padding: 30px 0; font-size: 0.9rem; }
        .status-text { font-size: 0.85rem; font-weight: bold; }

        /* é—ªçƒæç¤ºæ–°è®¢å• */
        .flash-bg { animation: flash 1s infinite; }
        @keyframes flash {
            0% { background-color: var(--merch-bg); }
            50% { background-color: #fffde7; }
            100% { background-color: var(--merch-bg); }
        }

        /* å“åº”å¼é€‚é… */
        @media (max-width: 900px) {
            .main-stage { grid-template-columns: 1fr; overflow-y: auto; display: block; }
            .role-panel { margin-bottom: 20px; height: 500px; }
            body { overflow: auto; }
        }
    </style>
</head>
<body>

<div id="app">
    <header>
        <i class="fas fa-hamburger"></i> å…¨æµç¨‹å¤–å–ä»¿çœŸç³»ç»Ÿ Pro
    </header>

    <div class="main-stage">
        
        <!-- ==================== ç”¨æˆ·ç«¯ ==================== -->
        <div class="role-panel role-user">
            <div class="panel-header">
                <span><i class="fas fa-mobile-alt"></i> ç”¨æˆ·ç‚¹é¤</span>
                <span style="font-size:0.8em; font-weight:normal">ä½™é¢: Â¥999</span>
            </div>
            
            <div class="panel-content">
                <!-- é…é€æ–¹å¼ -->
                <div style="background: white; padding: 4px; border-radius: 8px; display: flex; margin-bottom: 15px; border:1px solid #eee;">
                    <div style="flex:1; text-align:center; padding:8px; border-radius:6px; cursor:pointer;" 
                         :style="orderForm.type==='delivery'?'background:var(--user-main);color:white':'color:#666'"
                         @click="orderForm.type='delivery'">
                        å¤–å–é…é€
                    </div>
                    <div style="flex:1; text-align:center; padding:8px; border-radius:6px; cursor:pointer;"
                         :style="orderForm.type==='pickup'?'background:var(--user-main);color:white':'color:#666'"
                         @click="orderForm.type='pickup'">
                        åˆ°åº—è‡ªå–
                    </div>
                </div>

                <!-- èœå“åˆ—è¡¨ -->
                <div class="menu-grid">
                    <div class="menu-item" v-for="item in menu" :key="item.id" 
                         :class="{active: orderForm.items.find(i=>i.id===item.id)}"
                         @click="toggleItem(item)">
                        <div style="font-size:24px">{{item.icon}}</div>
                        <div style="font-weight:bold; margin:5px 0">{{item.name}}</div>
                        <div style="color:var(--gray)">Â¥{{item.price}}</div>
                    </div>
                </div>

                <!-- å†å²è®¢å•æµ (å€’åº) -->
                <div style="margin-top: 20px; border-top: 1px solid #eee; padding-top: 10px;">
                    <h4 style="margin: 0 0 10px 0; color: #555;">è¿›è¡Œä¸­çš„è®¢å•</h4>
                    <div v-for="order in activeUserOrders" :key="order.id" class="order-card">
                        <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                            <span style="font-weight:bold">{{order.shopName}}</span>
                            <span class="status-text" :style="{color: getStatusColor(order.statusCode)}">
                                {{order.statusText}}
                            </span>
                        </div>
                        <div style="font-size:0.85rem; color:#666; margin-bottom:8px;">
                            {{ order.items.map(i=>i.name).join('+') }} 
                        </div>
                        
                        <!-- è¿›åº¦æ¡æ¨¡æ‹Ÿ -->
                        <div style="height:4px; background:#eee; border-radius:2px; overflow:hidden; margin-bottom:8px;">
                            <div :style="{width: getProgress(order.statusCode)+'%', background: getStatusColor(order.statusCode)}" 
                                 style="height:100%; transition: width 0.5s;"></div>
                        </div>

                        <div v-if="['delivering','wait_pickup'].includes(order.statusCode)" style="text-align:right">
                            <button class="btn btn-blue" style="width:auto; display:inline-block; font-size:12px; padding:5px 10px;"
                                    @click="confirmReceipt(order)">
                                {{order.type==='delivery' ? 'ç¡®è®¤æ”¶è´§' : 'æˆ‘å·²å–é¤'}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="panel-footer">
                <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-weight:bold;">
                    <span>åˆè®¡:</span>
                    <span style="font-size:1.2em">Â¥{{cartTotal}}</span>
                </div>
                <button class="btn btn-blue" :disabled="cartTotal===0" @click="submitOrder">
                    <span v-if="isSubmitting"><i class="fas fa-spinner fa-spin"></i> å¤„ç†ä¸­...</span>
                    <span v-else>ç«‹å³æ”¯ä»˜</span>
                </button>
            </div>
        </div>

        <!-- ==================== å•†å®¶ç«¯ ==================== -->
        <div class="role-panel role-merchant" :class="{'flash-bg': hasNewOrder}">
            <div class="panel-header">
                <span><i class="fas fa-store"></i> å•†å®¶æ¥å•å°</span>
                <label style="font-size:12px; font-weight:normal; cursor:pointer;">
                    <input type="checkbox" v-model="autoPrint"> è‡ªåŠ¨æ¥å•
                </label>
            </div>

            <div class="tabs">
                <div class="tab" :class="{active: merchTab==='new'}" @click="merchTab='new'">
                    æ–°è®¢å• <span class="badge" v-if="merchNewCount > 0">{{merchNewCount}}</span>
                </div>
                <div class="tab" :class="{active: merchTab==='processing'}" @click="merchTab='processing'">
                    åˆ¶ä½œä¸­ <span class="badge" v-if="merchProcessCount > 0">{{merchProcessCount}}</span>
                </div>
            </div>

            <div class="panel-content">
                <div v-if="merchList.length === 0" class="empty-state">
                    <i class="fas fa-coffee" style="font-size:2em; margin-bottom:10px; display:block;"></i>
                    æš‚æ— ç›¸å…³è®¢å•
                </div>

                <div v-for="order in merchList" :key="order.id" 
                     class="receipt-card" 
                     :class="{'printing-animation': order.isPrinting}">
                    
                    <!-- æ¨¡æ‹Ÿå°ç¥¨æ ·å¼ -->
                    <div style="padding: 15px;">
                        <div class="receipt-header">
                            #{{order.daySeq}} {{order.type==='delivery'?'å¤–å–':'è‡ªå–'}}
                        </div>
                        <div class="receipt-row" style="color:#888; font-size:12px;">
                            <span>ä¸‹å•æ—¶é—´:</span><span>{{order.time}}</span>
                        </div>
                        <div class="receipt-divider"></div>
                        <div v-for="item in order.items" class="receipt-row">
                            <span>{{item.name}}</span>
                            <span>x1</span>
                        </div>
                        <div class="receipt-divider"></div>
                        <div class="receipt-row" style="font-weight:bold; font-size:1.1em;">
                            <span>å®ä»˜:</span>
                            <span>Â¥{{order.total}}</span>
                        </div>
                        <div style="margin-top:10px; font-size:12px;">
                            å¤‡æ³¨: {{order.remark || 'æ— å¤‡æ³¨'}}
                        </div>
                    </div>

                    <!-- æ“ä½œæŒ‰é’®åŒº -->
                    <div style="background:#f9f9f9; padding:10px; border-top:1px dashed #ccc;">
                        <template v-if="order.statusCode === 'pending'">
                            <button class="btn btn-orange" @click="merchantAccept(order)">
                                æ¥å• & æ‰“å°
                            </button>
                        </template>
                        <template v-if="order.statusCode === 'cooking'">
                            <button class="btn btn-orange" @click="merchantFinish(order)">
                                {{order.type==='delivery'?'å‡ºé¤ (å‘¼å«éª‘æ‰‹)':'å‡ºé¤ (é€šçŸ¥å–é¤)'}}
                            </button>
                        </template>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== éª‘æ‰‹ç«¯ ==================== -->
        <div class="role-panel role-rider">
            <div class="panel-header">
                <span><i class="fas fa-motorcycle"></i> éª‘æ‰‹é…é€</span>
                <span style="font-size:0.8em; color:#333">ä»Šæ—¥èµš: Â¥{{riderIncome}}</span>
            </div>

            <div class="tabs">
                <div class="tab" :class="{active: riderTab==='pool'}" @click="riderTab='pool'">
                    æŠ¢å•å¤§å… <span class="badge" v-if="riderPoolCount>0">{{riderPoolCount}}</span>
                </div>
                <div class="tab" :class="{active: riderTab==='mine'}" @click="riderTab='mine'">
                    é…é€ä¸­ <span class="badge" v-if="riderMineCount>0">{{riderMineCount}}</span>
                </div>
            </div>

            <div class="panel-content">
                <div v-if="riderList.length === 0" class="empty-state">
                    {{riderTab==='pool'?'æš‚æ— å¾…æŠ¢è®¢å•ï¼Œä¼‘æ¯ä¸€ä¸‹':'å½“å‰æ²¡æœ‰é…é€ä»»åŠ¡'}}
                </div>

                <div v-for="order in riderList" :key="order.id" class="order-card" style="border-left: 4px solid var(--rider-main);">
                    <div style="display:flex; justify-content:space-between; font-weight:bold; margin-bottom:8px;">
                        <span><i class="fas fa-map-marker-alt" style="color:red"></i> {{order.distance}}km</span>
                        <span style="color:#f57c00; font-size:1.1em">Â¥{{order.deliveryFee}}</span>
                    </div>
                    
                    <div style="font-size:13px; color:#555; line-height:1.6;">
                        <div><strong>å–:</strong> ç¾å‘³å¤§é¥­åº— ({{order.daySeq}}å·)</div>
                        <div><strong>é€:</strong> {{order.address}}</div>
                        <div style="color:#999; margin-top:4px;">{{order.items.length}} ä»¶å•†å“ | é¢„è®¡ {{order.eta}} åˆ†é’Ÿé€è¾¾</div>
                    </div>

                    <div style="margin-top:12px;">
                        <button v-if="order.statusCode === 'wait_rider'" class="btn btn-green" @click="riderGrab(order)">
                            æŠ¢å•
                        </button>
                        <button v-if="order.statusCode === 'delivering'" class="btn btn-green" @click="riderArrive(order)">
                            ç¡®è®¤é€è¾¾
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script>
const { createApp, reactive, computed, ref } = Vue;

createApp({
    setup() {
        // === æ•°æ®å®šä¹‰ ===
        const menu = [
            { id: 1, name: 'æ‹›ç‰Œç‰›è‚‰é¢', price: 28, icon: 'ğŸœ' },
            { id: 2, name: 'è¶…çº§é¸¡è…¿å ¡', price: 18, icon: 'ğŸ”' },
            { id: 3, name: 'å¤§æ¯å†°å¯ä¹', price: 8, icon: 'ğŸ¥¤' },
            { id: 4, name: 'è„†çš®ç‚¸é¸¡ç¿…', price: 12, icon: 'ğŸ—' },
            { id: 5, name: 'æ°´æœæ²™æ‹‰ç¢—', price: 22, icon: 'ğŸ¥—' },
            { id: 6, name: 'æ—¥å¼è±šéª¨é¥­', price: 35, icon: 'ğŸ›' }
        ];

        // å…¨å±€è®¢å•æ±  (æ¨¡æ‹Ÿæ•°æ®åº“)
        const orders = reactive([]);
        
        // UI çŠ¶æ€
        const orderForm = reactive({ type: 'delivery', items: [] });
        const isSubmitting = ref(false);
        const autoPrint = ref(false);
        const merchTab = ref('new');
        const riderTab = ref('pool');
        const riderIncome = ref(0);
        const daySeqCounter = ref(1); // æ¯æ—¥æµæ°´å·

        // === è®¡ç®—å±æ€§ ===
        const cartTotal = computed(() => orderForm.items.reduce((sum, i) => sum + i.price, 0));
        
        const activeUserOrders = computed(() => 
            orders.filter(o => o.statusCode !== 'completed').reverse()
        );

        const merchList = computed(() => {
            if (merchTab.value === 'new') return orders.filter(o => o.statusCode === 'pending');
            return orders.filter(o => o.statusCode === 'cooking' || (o.type==='pickup' && o.statusCode==='wait_pickup'));
        });

        const riderList = computed(() => {
            if (riderTab.value === 'pool') return orders.filter(o => o.statusCode === 'wait_rider');
            return orders.filter(o => o.statusCode === 'delivering');
        });

        // è®¡æ•°å™¨
        const merchNewCount = computed(() => orders.filter(o => o.statusCode === 'pending').length);
        const merchProcessCount = computed(() => orders.filter(o => o.statusCode === 'cooking').length);
        const riderPoolCount = computed(() => orders.filter(o => o.statusCode === 'wait_rider').length);
        const riderMineCount = computed(() => orders.filter(o => o.statusCode === 'delivering').length);
        const hasNewOrder = computed(() => merchNewCount.value > 0);

        // === ä¸šåŠ¡é€»è¾‘ ===

        // 1. ç”¨æˆ·æ“ä½œ
        const toggleItem = (item) => {
            const idx = orderForm.items.findIndex(i => i.id === item.id);
            if (idx > -1) orderForm.items.splice(idx, 1);
            else orderForm.items.push({...item}); // push copy
        };

        const submitOrder = () => {
            isSubmitting.value = true;
            
            // æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚å»¶è¿Ÿ
            setTimeout(() => {
                const newOrder = {
                    id: Date.now(),
                    daySeq: daySeqCounter.value++, // æµæ°´å· #1, #2...
                    type: orderForm.type,
                    items: [...orderForm.items],
                    total: cartTotal.value,
                    shopName: 'ç¾å‘³å¤§é¥­åº—',
                    time: new Date().toLocaleTimeString(),
                    address: 'ç§‘æŠ€å›­Båº§ 1808',
                    statusCode: 'pending',
                    statusText: 'ç­‰å¾…å•†å®¶æ¥å•',
                    // é…é€ç›¸å…³æ¨¡æ‹Ÿæ•°æ®
                    distance: (Math.random() * 3 + 1).toFixed(1),
                    deliveryFee: Math.floor(Math.random() * 5 + 4),
                    eta: Math.floor(Math.random() * 20 + 15),
                    // UI æ ‡å¿—
                    isPrinting: true 
                };

                orders.push(newOrder);
                orderForm.items = [];
                isSubmitting.value = false;

                // å¦‚æœå¼€å¯è‡ªåŠ¨æ¥å•
                if (autoPrint.value) {
                    setTimeout(() => merchantAccept(newOrder), 2000);
                }
            }, 800);
        };

        const confirmReceipt = (order) => {
            order.statusCode = 'completed';
            order.statusText = 'å·²å®Œæˆ';
        };

        // 2. å•†å®¶æ“ä½œ
        const merchantAccept = (order) => {
            // æ¨¡æ‹Ÿæ‰“å°æœºé€Ÿåº¦ï¼Œå…ˆè®©çŠ¶æ€å˜ä¸º "Printing" (UIä¸Šè¡¨ç°ä¸º pending ä½†æˆ‘ä»¬åœ¨CSSåšåŠ¨ç”»)
            // è¿™é‡Œå®é™…ä¸Šæ˜¯æ”¹å˜çŠ¶æ€ä¸º cooking
            order.isPrinting = false; // åœæ­¢è¿›å…¥åŠ¨ç”»
            order.statusCode = 'cooking';
            order.statusText = 'å•†å®¶åˆ¶ä½œä¸­';
            merchTab.value = 'processing';
        };

        const merchantFinish = (order) => {
            if (order.type === 'delivery') {
                order.statusCode = 'wait_rider';
                order.statusText = 'ç­‰å¾…éª‘æ‰‹æ¥å•';
            } else {
                order.statusCode = 'wait_pickup';
                order.statusText = 'å¾…å–é¤';
            }
        };

        // 3. éª‘æ‰‹æ“ä½œ
        const riderGrab = (order) => {
            order.statusCode = 'delivering';
            order.statusText = 'éª‘æ‰‹å·²æ¥å•ï¼Œé…é€ä¸­';
            riderTab.value = 'mine';
        };

        const riderArrive = (order) => {
            // é€è¾¾åä¸ç›´æ¥ç»“æŸï¼Œè€Œæ˜¯å˜ä¸ºç­‰å¾…ç”¨æˆ·ç¡®è®¤ï¼Œæˆ–è€…ç›´æ¥å®Œæˆ
            // è¿™é‡Œä¸ºäº†ç®€åŒ–ç›´æ¥ç»™ç”¨æˆ·ç¡®è®¤
            // å¢åŠ æ”¶å…¥
            riderIncome.value += order.deliveryFee;
            // ä¸ºäº†æ¼”ç¤ºï¼Œå…ˆä¸è‡ªåŠ¨å®Œæˆï¼Œè®©ç”¨æˆ·ç‚¹ç¡®è®¤æ”¶è´§ï¼Œæˆ–è€…éª‘æ‰‹ç‚¹é€è¾¾å°±å˜æˆç”¨æˆ·å¾…æ”¶è´§
            order.statusText = 'éª‘æ‰‹å·²é€è¾¾';
            // éª‘æ‰‹ä»»åŠ¡åˆ—è¡¨ç§»é™¤ï¼ˆé€»è¾‘ä¸Šå®Œæˆé…é€ä»»åŠ¡ï¼‰
            // ä½†ä¸ºäº†UIçŠ¶æ€åŒæ­¥ï¼Œæˆ‘ä»¬æš‚æ—¶æŠŠçŠ¶æ€æ”¹ä¸º 'delivering' ä¿æŒæ˜¾ç¤ºï¼Œæˆ–è€…ç§»é™¤
            // è¿™é‡Œæ”¹ä¸ºï¼š
            order.statusCode = 'completed'; // ç®€å•å¤„ç†
            order.statusText = 'è®¢å•ç»“æŸ';
        };

        // å·¥å…·å‡½æ•°
        const getStatusColor = (code) => {
            const map = {
                'pending': '#ff9800',
                'cooking': '#795548',
                'wait_rider': '#2196f3',
                'delivering': '#4caf50',
                'wait_pickup': '#e65100',
                'completed': '#9e9e9e'
            };
            return map[code] || '#000';
        };
        
        const getProgress = (code) => {
            const map = {
                'pending': 10,
                'cooking': 30,
                'wait_rider': 50,
                'delivering': 80,
                'wait_pickup': 80,
                'completed': 100
            };
            return map[code] || 0;
        };

        return {
            menu, orderForm, isSubmitting, cartTotal, autoPrint, riderIncome,
            activeUserOrders, merchList, riderList,
            merchNewCount, merchProcessCount, riderPoolCount, riderMineCount, hasNewOrder,
            merchTab, riderTab,
            toggleItem, submitOrder, confirmReceipt, merchantAccept, merchantFinish, riderGrab, riderArrive,
            getStatusColor, getProgress
        };
    }
}).mount('#app');
</script>
</body>
</html>
